%% File: csumtoc.sty
%% Copyright 2022 A. Hoendervangers
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is A. Hoendervangers
%
% This work consists of the files csum.cls, csumhdr.sty,
% csuminf.sty, csumsec.sty, csumtoc.sty, and csumttl.sty.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{csumtoc}[2022/05/06 version 1.00 Course Summary section headers]

%%  USED PACKAGES   %%
\RequirePackage{tocloft}
\RequirePackage{calc}

%%  GENERAL %%
\AtBeginDocument{%
  \@ifpackageloaded{fancyhdr}%
    {\newcommand{\@posttochead}{\pagestyle{fancy}}}%
    {\newcommand{\@posttochead}{\pagestyle{plain}}}%
}%


% new command to print toc
\AtBeginDocument{%
  \let\@printtoc\tableofcontents%
  \renewcommand{\tableofcontents}{%
    \pagestyle{plain}%
    \@printtoc%
    \noindent\rule{\textwidth}{2pt}%
    \vspace{-0.7\baselineskip}%
    \newline%
    \noindent%
    \rule{0.025\textwidth}{0pt}%
    \rule{0.95\textwidth}{1pt}%
    \clearpage%
    \pagenumbering{arabic}%
    \@posttochead%
  }%
}%

% justify part page numbers to right of toc
\renewcommand{\@tocrmarg}{0em}

% change name of toc and add rule
\renewcommand{\contentsname}{%
  Table of Contents \vspace{-0.4\baselineskip} \\%
  \noindent\rule{\textwidth}{2pt}\vspace{-0.4\baselineskip}%
}%

\setcounter{tocdepth}{2}

%%  PARTS %%
\renewcommand{\cftpartafterpnum}{%
  \vspace{-0.6\baselineskip}\newline%
  \rule{\textwidth}{1pt}\vspace{-0.2\baselineskip}%
}%

\renewcommand{\cftpartpagefont}{%
  \sffamily%
}%

%%  SECTIONS  %%
\renewcommand{\cftsecfont}{\sffamily\bfseries}%

\setlength{\cftsecindent}{2em}%

\AtBeginDocument{%
  \setlength{\cftsecnumwidth}{\widthof{\thesection}}%
}%

\renewcommand{\cftsecpagefont}{\sffamily}%

%%  SUBSECTIONS %%
\setlength{\cftsubsecindent}{4em}%

\renewcommand{\cftsubsecfont}{\sffamily}%

\renewcommand{\cftsubsecpagefont}{\sffamily}%

\AtBeginDocument{%
  \setlength{\cftsubsecnumwidth}{\widthof{\thesubsection}}%
}%
