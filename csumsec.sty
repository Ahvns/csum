%%  IDENTIFICATION  %%
%   Provides custom section headers for course summary document class
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{csumsec}[2022/05/06 version 1.00 Course Summary section headers]

%%  USED PACKAGES   %%
\RequirePackage{titlesec}%
\RequirePackage{setspace}%
\RequirePackage{xstring}%

%%  CODE    %%
% option commands
\newcommand{\@sectype}{course}%
\newcommand{\@csecname}{}%
\newcommand{\@csecprename}{}%
\newcommand{\@csubsecname}{}%
\newcommand{\@cpartname}{}%
\newcommand{\@cpartformat}{}%

\newcommand{\@courseoptions}{%
  \renewcommand{\@csecname}{Lecture~\arabic{section}}%
  \renewcommand{\@csecprename}{\hfill}%
  \renewcommand{\@csubsecname}{\arabic{section}.\arabic{subsection}~~}%
  \renewcommand{\@cpartname}{Part~\Roman{part}:}%
  \renewcommand{\@cpartformat}{display}%
}%

\newcommand{\@articleoptions}{%
  \renewcommand{\@csecname}{}%
  \renewcommand{\@csecprename}{}%
  \renewcommand{\@csubsecname}{}%
  \renewcommand{\@cpartname}{Subject:~}%
  \renewcommand{\@cpartformat}{hang}%
}%


\newcommand{\sectiontype}[1]{%
  % Check if input is equal to one of specified options, otherwise revert to default
  \IfStrEqCase{#1}{%
    {course}{\renewcommand{\@sectype}{course}}%
    {article}{\renewcommand{\@sectype}{article}}%
  }%
  % Change settings per option
  \IfStrEqCase{\@sectype}{%
    % Course option
    {course}{\@courseoptions}%
    % Article option
    {article}{\@articleoptions}%
  }%
}%

\sectiontype{}% initialise



%%  FORMAT  %%
%   Sections    %
%{
\renewcommand{\thesection}{\@csecname}%

\titleformat%
  {\section}%
  [hang]%
  {\bfseries\Large}%
  {\thesection}%
  {0.5ex}%
  {\@csecprename}
  [\vspace{-2ex}\rule{\textwidth}{2pt}]%

\newcommand{\sectionbreak}{%
  \vspace{-1ex}%
  \noindent%
  \rule{\textwidth}{2pt}%
  \clearpage%
}%
%}
%   Subsections %
\titleformat%
  {\subsection}%
  [hang]%
  {\sffamily\bfseries\large}%
  {\thesubsection}%
  {0.25ex}%
  {}%
  [\vspace{-2ex}\rule{0.75\textwidth}{1pt}]%

\newcommand{\subsectionbreak}{%
  \vspace{-1ex}%
  \noindent\rule{0.25\textwidth}{0pt}%
  \rule{0.75\textwidth}{1pt}%
  \clearpage%
}%

\renewcommand{\thesubsection}{\@csubsecname}%

%   Subsubsections  %
\titleformat%
    {\subsubsection}%
    [hang]%
    {\sffamily\bfseries}%
    {~}%
    {0.125ex}%
    {}%
    [\vspace{-2ex}\rule{0.5\textwidth}{0.5pt}]%

\renewcommand{\thesubsubsection}{}%

%   Parts   %
\renewcommand{\thepart}{\@cpartname}%
\renewcommand{\partname}{}%

\AtEndDocument{%
    \noindent%
    \rule{\textwidth}{2pt}%
    \vspace{-0.7\baselineskip}%
    \newline%
    \noindent%
    \rule{0.025\textwidth}{0pt}%
    \rule{0.95\textwidth}{1pt}%
    }%

\AtBeginDocument{%
  \titleformat%
    {\part}%
    [\@cpartformat]%
    {%
    \ifnum\value{part}>1%
      \vspace{-1.7\baselineskip}%
      \newline%
      \noindent%
      \rule{\textwidth}{2pt}%
      \vspace{-0.7\baselineskip}%
      \newline%
      \noindent%
      \rule{0.025\textwidth}{0pt}%
      \rule{0.95\textwidth}{1pt}%
      \clearpage%
    \else%
      \vspace*{-7em}%
    \fi%
    \singlespacing
    \bfseries%
    \huge%
    }%
    {\thepart}%
    {0.5ex}%
    {}%
    [%
    \ifnum\value{part}=1%
      \vspace{-1.2ex}%
    \else%
      \vspace{-1ex}
    \fi]%
}%
