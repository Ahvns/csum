%%  IDENTIFICATION  %%
%   Provides custom section headers for course summary document class
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{csumsec}[2022/05/06 version 1.00 Course Summary section headers]

%%  USED PACKAGES   %%
\RequirePackage{titlesec}%
\RequirePackage{setspace}%
\RequirePackage{xstring}%

%%  CODE    %%
% option commands
\newcommand{\@csecname}{}%
\newcommand{\@csecprename}{}%
\newcommand{\@csubsecname}{}%
\newcommand{\@cpartname}{}%
\newcommand{\@cpartformat}{}%
\newcommand{\@cparttypeset}{}%

\newcommand{\@cseccourseoptions}{%
  \renewcommand{\@csecname}{Lecture~\arabic{section}\hspace{1em}}%
  \renewcommand{\@csecprename}{\hfill}%
  \renewcommand{\@csubsecname}{\arabic{section}.\arabic{subsection}~~}%
  \renewcommand{\@cpartname}{\Large Part~\Roman{part}:}%
  \renewcommand{\@cpartformat}{display}%
  \renewcommand{\@cparttypeset}{\vspace{-0.5\baselineskip}\huge}%
}%

\newcommand{\@csecarticleoptions}{%
  \renewcommand{\@csecname}{}%
  \renewcommand{\@csecprename}{}%
  \renewcommand{\@csubsecname}{}%
  \renewcommand{\@cpartname}{Subject:}%
  \renewcommand{\@cpartformat}{hang}%
  \renewcommand{\@cparttypeset}{\LARGE}%
}%


\newcommand{\sectiontype}[1]{%
  % Check if input is equal to one of specified options, otherwise revert to default
  \IfStrEqCase{#1}{%
    {course}{\@cseccourseoptions}%
    {article}{\@csecarticleoptions}%
  }%
}%

\sectiontype{course}% initialise

%%  FORMAT  %%
%   Sections    %
%{
\renewcommand{\thesection}{\@csecname}%

\titleformat%
  {\section}%
  [hang]%
  {\bfseries\Large}%
  {\thesection}%
  {0.5ex}%
  {\@csecprename}
  [\vspace{-2ex}\rule{\textwidth}{2pt}\vspace{-0.5\baselineskip}]%

\newcommand{\sectionbreak}{%
  \vspace{-1ex}%
  \noindent%
  \rule{\textwidth}{2pt}%
  \clearpage%
}%
%}
%   Subsections %
\titleformat%
  {\subsection}%
  [hang]%
  {\sffamily\bfseries\large}%
  {\thesubsection}%
  {0.25ex}%
  {}%
  [\vspace{-2ex}\rule{0.75\textwidth}{1pt}\vspace{-0.5\baselineskip}]%

\newcommand{\subsectionbreak}{%
  \vspace{-1ex}%
  \noindent\rule{0.25\textwidth}{0pt}%
  \rule{0.75\textwidth}{1pt}%
  \clearpage%
}%

\renewcommand{\thesubsection}{\@csubsecname}%

%   Subsubsections  %
\titleformat%
    {\subsubsection}%
    [hang]%
    {\sffamily\bfseries}%
    {~}%
    {0.125ex}%
    {}%
    [\vspace{-2ex}\rule{0.5\textwidth}{0.5pt}\vspace{-0.4\baselineskip}]%

\renewcommand{\thesubsubsection}{}%

%   Parts   %
\renewcommand{\thepart}{\@cpartname\hspace{-0.6em}}%
\renewcommand{\partname}{}%

\AtEndDocument{%
    \noindent%
    \rule{\textwidth}{2pt}%
    \vspace{-0.7\baselineskip}%
    \newline%
    \noindent%
    \rule{0.025\textwidth}{0pt}%
    \rule{0.95\textwidth}{1pt}%
    }%

\AtBeginDocument{%
  \titleformat%
    {\part}%
    [\@cpartformat]%
    {%
    \ifnum\value{part}>1%
      \vspace{-1.7\baselineskip}%
      \newline%
      \noindent%
      \rule{\textwidth}{2pt}%
      \vspace{-0.7\baselineskip}%
      \newline%
      \noindent%
      \rule{0.025\textwidth}{0pt}%
      \rule{0.95\textwidth}{1pt}%
      \clearpage%
    \else%
      \vspace*{-5em}%
    \fi%
    \singlespacing%
    \bfseries%
    }%
    {\LARGE\thepart}%
    {1em}%
    {\@cparttypeset}%
    [%
    \ifnum\value{part}=1%
      \vspace{-0.7\baselineskip}%
    \else%
      \vspace{-1ex}
    \fi]%
}%
