%%  IDENTIFICATION  %%
%   Provides headers for course summary document class
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{csumhdr}[2022/05/06 version 1.00 Course Summary headers]

%%  USED PACKAGES   %%
\RequirePackage{fancyhdr}%
\RequirePackage{xcolor}%
\RequirePackage{xstring}%
\RequirePackage{csuminf}%

%%  CODE    %%
\pagestyle{fancy}%
\fancyhf{}%

\newcommand{\@cfooter}{}%
\newcommand{\@crhead}{}%
\newcommand{\@clhead}{}%

\newcommand{\@chdrcourseoptions}{%
  \renewcommand{\partmark}[1]{\markboth{}{##1}}%
  \renewcommand{\sectionmark}[1]{%
    \renewcommand{\@csec}{##1}%
    \markboth{}{##1}%
  }%
  \renewcommand{\subsectionmark}[1]{\markboth{##1}{\@csec}}%
  \renewcommand{\@cfooter}{%
    Summary~for~%
    \ifx\@coursecode\@empty%
        \relax%
    \else%
        \textsc{\@coursecode}~---~%
    \fi%
    \@course%
  }%
  \renewcommand{\@crhead}{\leftmark}%
  \renewcommand{\@clhead}{\rightmark}%
}%

\newcommand{\@chdrarticleoptions}{%
  \renewcommand{\partmark}[1]{%
    \markright{##1}%
    \def\@chdrpartname{##1}%
  }%
  \renewcommand{\sectionmark}[1]{\markboth{##1}{\@chdrpartname}}%
  \renewcommand{\subsectionmark}[1]{}%
  \renewcommand{\@cfooter}{Article~notes~for~\@course}%
  \renewcommand{\@crhead}{\rightmark}%
  \renewcommand{\@clhead}{\leftmark}%
}%

\newcommand{\headertype}[1]{%
  % Check if input is equal to one of specified options, otherwise revert to default
  \IfStrEqCase{#1}{%
    {course}{\@chdrcourseoptions}%
    {article}{\@chdrarticleoptions}%
  }%
}%

\headertype{course}% initialise

\renewcommand{\headrulewidth}{0pt}%

\newcommand{\@csec}{}%

\setlength{\headheight}{0pt}%
\fancyheadoffset{0pt}%

%%  FOOTER  %%
\rfoot{\thepage}%

\lfoot{%
  \sffamily%
  \footnotesize%
  \textcolor{gray}{\@cfooter}%
}%

%%  HEADER  %%
\rhead{\sffamily\footnotesize\textcolor{gray}{\@crhead}}%

\lhead{\sffamily\small\textcolor{gray}{\@clhead}}%
